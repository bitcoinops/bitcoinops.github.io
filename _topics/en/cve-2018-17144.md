---
title: CVE-2018-17144

## Optional.  An entry will be added to the topics index for each alias
aliases:
  - Duplicate inputs vulnerability

## Required.  At least one category to which this topic belongs.  See
## schema for options
categories:
  - Security Problems

## Required.  Use Markdown formatting.  Only one paragraph.  No links allowed.
excerpt: >
  **CVE-2018-17144** was a bug that could have allowed an attacker to
  spend the same bitcoins more than once.

## Optional.  Use Markdown formatting.  Multiple paragraphs.  Links allowed.
extended_summary: |
  An optimization included in Bitcoin Core 0.14.0 skipped a check on
  newly-received blocks that was thought to be redundant, making the
  node willing to partly process blocks that tried to spend the same
  input more than once.  This would trigger some code meant to catch
  unexpected node operation and cause the node to deliberately crash.
  This allowed a denial-of-service attack that could be exploited by
  miners.

  The code meant to catch unexpected operation (an assert) was rewritten
  for Bitcoin Core 0.15.0, unintentionally allowing the node to continue
  operation in the case of duplication inputs.  This allowed a miner to
  spend the same bitcoins more than once.

  The vulnerability was discovered and responsibly disclosed by
  developer Awemany on 17 September 2018.  Patches were available within
  hours, and a binary release for the current release branch within 36
  hours---both only mentioning the DoS vulnerability.  After several
  developers reviewing the patch were able to reverse engineer the bug
  and discover the inflation risk, a full disclosure was made by Bitcoin
  Core developers on 20 September 2018.

  The bug was never exploited on Bitcoin mainnet and an overwhelming
  majority of full nodes subsequently updated to unaffected versions of
  Bitcoin Core.

  After the full disclosure, the bug was exploited on Bitcoin testnet,
  causing any nodes still running Bitcoin Core 0.14.x to crash and nodes
  running 0.15.0 to 0.16.2 to accept a transaction that spent the same
  funds more than once.  When testnet miners managed to produce a valid
  chain with more proof-of-work than the invalid chain, those
  non-upgraded nodes attempted to switch to the new chain but were
  unable to fully un-spend a double-spent input.  This left the old
  testnet nodes stuck on a lower-proof-of-work block chain, requiring
  manual user intervention to fix them.

## Optional.  Produces a Markdown link with either "[title][]" or
## "[title](link)"
primary_sources:
    - title: CVE-2018-17144
    - title: CVE-2018-17144 Full Disclosure
      link: https://bitcoincore.org/en/2018/09/20/notice/
    - title: "Bitcoin Core PR #14247: Fix crash bug with duplicate inputs within a transaction"
      link: https://github.com/bitcoin/bitcoin/pull/14247

## Optional.  Each entry requires "title", "url", and "date".  May also use "feature:
## true" to bold entry
optech_mentions:
  - title: Upgrade to Bitcoin Core 0.16.3 to fix DoS vulnerability
    url: /en/newsletters/2018/09/18/#upgrade-to-bitcoin-core-0-16-3-to-fix-denial-of-service-vulnerability
    date: 2018-09-18

  - title: Upgrade to Bitcoin Core 0.16.3 to fix CVE-2018-17144
    url: /en/newsletters/2018/09/25/#upgrade-to-bitcoin-core-0-16-3-to-fix-cve-2018-17144
    date: 2018-09-25

  - title: Information about CVE-2018-17144
    url: /en/newsletters/2018/09/25/#cve-2018-17144
    date: 2018-09-25

  - title: CVE-2018-17144 exploited on testnet
    url: /en/newsletters/2018/10/02/#cve-2018-17144-duplicate-inputs-bug-exploited-on-testnet
    date: 2018-10-02

  - title: "2018 year-in-review: CVE-2018-17144"
    url: /en/newsletters/2018/12/28/#september
    date: 2018-12-28

  - title: "Talk summary: Near misses: what could have gone wrong"
    url: /en/newsletters/2019/10/16/#near-misses-what-could-have-gone-wrong
    date: 2019-10-16

## Optional.  Same format as "primary_sources" above
# see_also:
#   - title:
#     link:
---

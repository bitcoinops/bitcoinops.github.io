---
title: Block withholding

## Optional.  Shorter name to use for reference style links e.g., "foo"
## will allow using the link [topic foo][].  Not case sensitive
# shortname: foo

## Optional.  An entry will be added to the topics index for each alias
title-aliases:
  - Oblivious shares

## Required.  At least one category to which this topic belongs.  See
## schema for options
topic-categories:
  - Mining

## Optional.  Produces a Markdown link with either "[title][]" or
## "[title](link)"
primary_sources:
    - title: "Analysis of Bitcoin Pooled Mining Reward Systems (section 6.2: block withholding)"
      link: https://bitcoil.co.il/pool_analysis.pdf

## Optional.  Each entry requires "title" and "url".  May also use "feature:
## true" to bold entry and "date"
optech_mentions:
  - title: Block withholding attacks and potential solutions
    url: /en/newsletters/2024/08/09/#block-withholding-attacks-and-potential-solutions

## Optional.  Same format as "primary_sources" above
see_also:
  - title: Pooled mining
    link: topic pooled mining

## Optional.  Force the display (true) or non-display (false) of stub
## topic notice.  Default is to display if the page.content is below a
## threshold word count
#stub: false

## Required.  Use Markdown formatting.  Only one paragraph.  No links allowed.
## Should be less than 500 characters
excerpt: >
  **Block withholding** is an attack against pooled mining where a miner
  submits and receives payment for shares that are not eligible to
  become full blocks but doesn't not submit shares that are eligible to
  become full blocks.  This allows the miner to earn 99.9% of their
  expected revenue without the pool earning anything from the miner's
  work.  **Oblivious shares** is a proposed solution to block
  withholding.

---
In [pooled mining][topic pooled mining], there are two types of shares:
those that have
enough work to be a valid block and those that don't.  In a pure
pay-per-share (PPS) scheme, the pool pays the same amount for both types
but the pool only earns rewards from the Bitcoin system for producing
valid blocks.  This can allow a pool member to forfeit a small amount of
income in order to deny the pool a large amount of income.

For example, imagine the ratio between the network proof-of-work (PoW)
target and the pool share target is 1,000, so for every 1,000 shares
submitted by pool members,
the pool would be expected to find one block on average.  Malicious
pool member Mallory submits each share she finds except those that have
enough proof of work to be valid blocks.  On average, Mallory gets
paid for 999 shares out of every 1,000 she generates, reducing her
income by 0.1% but costing the pool 100% of a block reward for every
1,000 shares generated by Mallory.

If Mallory operates a pool, she might be motivated to use block
withholding attacks against other pools, significantly reducing their
profitability and potentially driving them out of business to Mallory's
advantage.

We are unaware of any deployed method that fully addresses this problem.
A common mitigation is for pools to pay more for shares that have enough
work to be a valid block (which implies paying less for other shares).
Some pools also restrict who can join their pools and use techniques
from statistical analysis to attempt to detect block withholders.

A proposed solution is _oblivious shares_, which prevents the miner
creating the share from determining whether it meets the network PoW
target.  Only the pool can make that determination, preventing the miner
from being able to selectively withhold shares that would benefit the
pool.  Adding support for oblivious shares to Bitcoin requires a hard
fork and may create [other problems][news315 oblivious].

{% include references.md %}
{% include linkers/issues.md issues="" %}
[news315 oblivious]: /en/newsletters/2024/08/09/#block-withholding-attacks-and-potential-solutions

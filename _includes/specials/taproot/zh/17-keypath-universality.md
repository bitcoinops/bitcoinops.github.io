{% auto_anchor %}

Gregory Maxwell 在[最初的 taproot 提案][maxwell taproot]中提出了一个有趣的合约设计原则：

> "几乎所有有趣的脚本都有一个逻辑顶层分支，允许所有参与者仅通过签名即可完成合约执行。其他分支仅在部分参与者不配合时使用。更加强调地说，我认为任何预先确定固定有限参与者的合约都应该表示为 N-of-N 签名与其他复杂合约条件的 OR 组合。"（原文强调）

此后，[专家][irc log1]们就此原则的[普适性][irc log2]展开辩论，目前已知的两个例外情况均与时间锁相关：

- ​**<!--consensus-augmented-self-control-->**​**共识强化的自我控制：​**​ 部分用户使用[时间锁][topic timelocks]阻止自己在特定期限内花费比特币。时间锁要求看似需要除签名外的额外条件，但存在以下争议：

  - 极度渴求资金的用户可通过其他资产担保获得贷款，这削弱了此类自控合约的效用。

  - 除共识强制的脚本路径时间锁外，用户可设置密钥路径支出，允许自身密钥与第三方密钥（仅在时间锁到期后签名）共同签署。这种方式不仅更高效，还能实现更灵活的支出策略，例如允许用户出售分叉币，或在重大生活变故或价格波动时通过第三方提前支取。

- ​**<!--vaults-->**​**保险库：​**​ 如 Antoine Poinsot 几周前在本站的[专栏][p4tr vaults]所述，[保险库][topic vaults]也广泛使用时间锁保护资金，这似乎"与 taproot 的核心洞见（即多数合约存在参与者协同签名的理想路径）相悖"。但有观点认为，保险库用户始终需要密钥路径作为逃生通道，且为脚本路径合约添加密钥路径选项无需额外成本，因此具备绝对优势。

反对始终提供密钥路径的观点认为，即使所有签名者共同行动，仍存在不信任自身的情况。他们转而信任其他主体——执行比特币共识规则的经济全节点运营者——来强制执行签名者不愿自我施加的支出限制。

反驳观点指出，至少在理论上，可以通过在常规签名者与所有经济全节点运营者之间创建密钥路径多签来获得同等安全性。更实际地说，或许存在某个节点运营者子集可加入密钥路径多签集来执行所需策略（若不可行，用户仍可通过脚本路径支出，因此并无损失）。

抛开理论探讨，我们建议在设计基于 taproot 的合约时，即使看似无需密钥路径，也应额外考量是否存有利用密钥路径的机会。

{% endauto_anchor %}

[p4tr vaults]: /zh/preparing-for-taproot/#使用-taproot-的保险库
[maxwell taproot]: https://gnusha.org/url/https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-January/015614.html
[irc log1]: https://gnusha.org/taproot-bip-review/2020-02-09.log
[irc log2]: https://gnusha.org/taproot-bip-review/2020-02-10.log
